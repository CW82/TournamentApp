<table border="1">
    <thead>
        <tr>
            <th>tournamentMatchesID</th>
            <th>tournamentID</th>
            <th>matchID</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {{#each tournamentMatches}}
        <tr data-id="{{tournamentMatchesID}}">
            <td>{{tournamentMatchesID}}</td>
            <td class="tournamentID">{{tournamentID}}</td>
            <td class="matchID">{{matchID}}</td>
            <td>
                <div class="action-buttons">
                    <button class="edit-btn">Edit</button>
                    <form method="POST" class="delete-button" action="/tournamentMatches/delete/{{tournamentMatchesID}}" style="display:inline">
                        <button type="submit" onclick="return confirmDelete('Record {{tournamentMatchesID}}')">Delete</button>
                    </form>
                </div>
            </td>
        </tr>
        {{/each}}
    </tbody>
</table>

<form action="/tournamentMatches/add" method="POST" class="add-form">
    <h3>Add New tournamentMatches</h3>
    <div class="form-row">
        <input type="text" name="tournamentID" placeholder="Tournament ID" required>
        <input type="text" name="matchID" placeholder="Match ID" required>
        <button type="submit">Add tournamentMatche</button>
    </div>
</form>

<script>
document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.edit-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const row = btn.closest('tr');
            const id = row.dataset.id;
            if (row.querySelector('input')) return;

            const cells = ['tournamentID','matchID'];
            cells.forEach(c => {
                const val = row.querySelector(`.${c}`).textContent;
                row.querySelector(`.${c}`).innerHTML = `<input type="text" name="${c}" value="${val}">`;
            });

            const saveBtn = document.createElement('button');
            saveBtn.textContent = 'Save';
            saveBtn.type = 'button';
            btn.replaceWith(saveBtn);

            saveBtn.addEventListener('click', async () => {
                const formData = new URLSearchParams();
                cells.forEach(c => formData.append(c, row.querySelector(`input[name="${c}"]`).value));

                const response = await fetch(`/tournamentMatches/update/${id}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: formData.toString()
                });

                if (response.ok) window.location.reload();
                else alert('Error updating record');
            });
        });
    });
});
</script>
